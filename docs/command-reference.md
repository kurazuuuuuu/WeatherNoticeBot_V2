# Discord Weather Bot コマンドリファレンス 📖

このドキュメントでは、Discord Weather Botで利用可能な全てのコマンドについて詳しく説明します。

## 📋 目次

1. [コマンド一覧](#コマンド一覧)
2. [天気情報コマンド](#天気情報コマンド)
3. [ユーザー設定コマンド](#ユーザー設定コマンド)
4. [管理者コマンド](#管理者コマンド)
5. [エラーハンドリング](#エラーハンドリング)
6. [使用例とベストプラクティス](#使用例とベストプラクティス)

## コマンド一覧

### 🌤️ 天気情報コマンド

| コマンド | 説明 | 権限 | 使用場所 |
|----------|------|------|----------|
| `/weather` | 現在の天気情報を表示 | 全ユーザー | サーバー・DM |
| `/forecast` | 5日間の天気予報を表示 | 全ユーザー | サーバー・DM |
| `/weather-alerts` | 気象警報・注意報を表示 | 全ユーザー | サーバー・DM |

### ⚙️ ユーザー設定コマンド

| コマンド | 説明 | 権限 | 使用場所 |
|----------|------|------|----------|
| `/set-location` | 地域を設定 | 全ユーザー | サーバー・DM |
| `/schedule-weather` | 定時通知を設定 | 全ユーザー | サーバー・DM |
| `/unschedule-weather` | 定時通知を停止 | 全ユーザー | サーバー・DM |
| `/my-settings` | 現在の設定を表示 | 全ユーザー | サーバー・DM |

### 👑 管理者コマンド

| コマンド | 説明 | 権限 | 使用場所 |
|----------|------|------|----------|
| `/weather-config` | サーバー設定管理 | 管理者 | サーバーのみ |
| `/stats` | ボット統計情報表示 | 管理者 | サーバーのみ |

## 天気情報コマンド

### `/weather [地域名]`

現在の天気情報を表示します。

#### パラメータ

- **地域名** (オプション): 天気情報を取得したい地域
  - 省略した場合: 設定済みの地域を使用
  - 未設定の場合: 地域設定を促すメッセージを表示

#### 使用例

```
/weather
/weather 東京都
/weather 大阪府大阪市
/weather 北海道札幌市
/weather とうきょうと
/weather Tokyo
```

#### 応答内容

- **天気状況**: 晴れ、曇り、雨など
- **気温**: 現在の気温（摂氏）
- **湿度**: 相対湿度（%）
- **風速・風向**: 風の情報
- **降水確率**: 降水の可能性（%）
- **発表時刻**: 情報の更新時刻
- **AIメッセージ**: ポジティブな励ましメッセージ（Gemini API利用時）

#### エラーパターン

1. **地域が見つからない場合**
   ```
   ❌ 指定された地域が見つかりませんでした。
   
   以下の形式で再度お試しください：
   • 都道府県名: 東京都、大阪府
   • 市区町村名: 横浜市、名古屋市
   • ひらがな: とうきょうと、おおさかふ
   ```

2. **地域が設定されていない場合**
   ```
   📍 地域が設定されていません。
   
   `/set-location 地域名` で地域を設定してください。
   例: /set-location 東京都
   ```

3. **API接続エラーの場合**
   ```
   ⚠️ 天気情報の取得に失敗しました。
   
   しばらく時間をおいて再度お試しください。
   ```

### `/forecast [地域名]`

5日間の天気予報を表示します。

#### パラメータ

- **地域名** (オプション): 天気予報を取得したい地域
  - 省略した場合: 設定済みの地域を使用

#### 使用例

```
/forecast
/forecast 神奈川県
/forecast 福岡県福岡市
```

#### 応答内容

各日について以下の情報を表示：
- **日付**: 予報対象日
- **天気**: 天気概況
- **最高気温**: 日中の最高気温
- **最低気温**: 夜間・早朝の最低気温
- **降水確率**: 降水の可能性
- **信頼度**: 予報の信頼度（A/B/C）

#### 表示形式

```
📅 5日間の天気予報 - 東京都

🌤️ 1月15日（月）
天気: 晴れ時々曇り
気温: 最高 12°C / 最低 3°C
降水確率: 10%
信頼度: A

☁️ 1月16日（火）
天気: 曇り
気温: 最高 8°C / 最低 1°C
降水確率: 30%
信頼度: B

...（5日分表示）
```

### `/weather-alerts [地域名]`

気象警報・注意報を表示します。

#### パラメータ

- **地域名** (オプション): 警報情報を取得したい地域

#### 使用例

```
/weather-alerts
/weather-alerts 沖縄県
/weather-alerts 静岡県
```

#### 応答内容

- **警報・注意報の種類**: 大雨、強風、波浪など
- **発表時刻**: 警報発表時刻
- **対象地域**: 警報対象の詳細地域
- **警報レベル**: 注意報・警報・特別警報
- **詳細説明**: 警報の内容

#### 表示形式

```
🚨 気象警報・注意報 - 沖縄県

⚠️ 大雨注意報
発表: 2024年1月15日 14:00
対象: 沖縄本島地方
内容: 15日夜遅くまで土砂災害に注意

🌊 波浪警報
発表: 2024年1月15日 10:00
対象: 沖縄本島地方
内容: 15日夜遅くまで高波に警戒
```

#### 警報がない場合

```
✅ 現在、気象警報・注意報は発表されていません。

最終確認: 2024年1月15日 15:30
```

## ユーザー設定コマンド

### `/set-location <地域名>`

ユーザーの地域を設定します。

#### パラメータ

- **地域名** (必須): 設定したい地域名

#### 使用例

```
/set-location 東京都
/set-location 神奈川県横浜市
/set-location 大阪府大阪市北区
/set-location とうきょうと
```

#### 対応地域形式

1. **都道府県名**
   - `東京都`、`大阪府`、`北海道`、`沖縄県`

2. **市区町村名**
   - `札幌市`、`仙台市`、`横浜市`、`名古屋市`

3. **詳細地域**
   - `東京都新宿区`、`大阪府大阪市北区`

4. **ひらがな・カタカナ**
   - `とうきょうと`、`おおさかふ`
   - `トウキョウト`、`オオサカフ`

5. **英語名**
   - `Tokyo`、`Osaka`、`Hokkaido`

#### 成功時の応答

```
✅ 地域を設定しました

📍 設定地域: 東京都
🌤️ 今後は地域を指定せずに天気コマンドを使用できます

試してみる: /weather
```

#### 複数候補がある場合

```
🔍 複数の候補が見つかりました

以下から選択してください：
1️⃣ 東京都
2️⃣ 東京都新宿区
3️⃣ 東京都渋谷区

番号で選択するか、より具体的な地域名を入力してください。
```

### `/schedule-weather <時間>`

指定した時間に天気情報をDMで受け取る設定をします。

#### パラメータ

- **時間** (必須): 通知を受け取りたい時間（0-23時）

#### 使用例

```
/schedule-weather 7    # 毎朝7時に通知
/schedule-weather 18   # 毎夕18時に通知
/schedule-weather 12   # 毎日12時に通知
```

#### 成功時の応答

```
⏰ 定時通知を設定しました

📍 地域: 東京都
🕐 通知時間: 毎日 7:00
📱 通知方法: DM（ダイレクトメッセージ）

通知内容:
• 現在の天気情報
• 今日の天気予報
• AIによるポジティブメッセージ
• 気象警報（発表時のみ）

停止する場合: /unschedule-weather
```

#### エラーパターン

1. **地域が未設定の場合**
   ```
   📍 地域が設定されていません。
   
   先に地域を設定してください:
   /set-location 地域名
   ```

2. **無効な時間の場合**
   ```
   ⚠️ 無効な時間です。
   
   0から23の間の数値を入力してください。
   例: /schedule-weather 7
   ```

### `/unschedule-weather`

定時通知を停止します。

#### パラメータ

なし

#### 使用例

```
/unschedule-weather
```

#### 成功時の応答

```
⏹️ 定時通知を停止しました

これまでの設定:
📍 地域: 東京都
🕐 通知時間: 毎日 7:00

再度設定する場合: /schedule-weather 時間
```

#### 通知が設定されていない場合

```
ℹ️ 定時通知は設定されていません。

通知を設定する場合: /schedule-weather 時間
例: /schedule-weather 7
```

### `/my-settings`

現在の設定を表示します。

#### パラメータ

なし

#### 使用例

```
/my-settings
```

#### 応答内容

```
⚙️ あなたの設定

👤 ユーザー: @username
📍 設定地域: 東京都
🕐 定時通知: 毎日 7:00 (有効)
📱 通知方法: DM
🤖 AI機能: 有効

📊 利用統計:
• 天気コマンド使用回数: 25回
• 予報コマンド使用回数: 12回
• 通知受信回数: 7回

設定変更:
• 地域変更: /set-location 地域名
• 通知設定: /schedule-weather 時間
• 通知停止: /unschedule-weather
```

#### 設定が未完了の場合

```
⚙️ あなたの設定

👤 ユーザー: @username
📍 設定地域: 未設定
🕐 定時通知: 無効

🔧 初期設定を完了してください:
1. /set-location 地域名 で地域を設定
2. /schedule-weather 時間 で通知を設定（オプション）
```

## 管理者コマンド

### `/weather-config`

サーバーの設定を管理します（管理者専用）。

#### 必要権限

- サーバー管理者権限
- または「サーバーを管理」権限

#### 使用例

```
/weather-config
```

#### 応答内容

```
🛠️ サーバー設定 - サーバー名

📊 統計情報:
• 登録ユーザー数: 45人
• 今日のコマンド実行数: 123回
• 通知設定ユーザー数: 23人

⚙️ サーバー設定:
• デフォルト地域: 東京都
• 通知チャンネル: #weather-updates
• AI機能: 有効

🔧 設定変更オプション:
1️⃣ デフォルト地域の変更
2️⃣ 通知チャンネルの設定
3️⃣ AI機能の有効/無効
4️⃣ ログレベルの変更

番号を選択してください。
```

### `/stats`

ボットの統計情報を表示します（管理者専用）。

#### 必要権限

- サーバー管理者権限

#### 使用例

```
/stats
```

#### 応答内容

```
📊 Discord Weather Bot 統計情報

🤖 ボット情報:
• 稼働時間: 5日 12時間 30分
• バージョン: v2.1.0
• 最終更新: 2024年1月15日

📈 使用統計（過去24時間）:
• 天気コマンド: 1,234回
• 予報コマンド: 567回
• 警報コマンド: 89回
• 設定コマンド: 123回

👥 ユーザー統計:
• 総登録ユーザー数: 2,345人
• アクティブユーザー数: 456人
• 通知設定ユーザー数: 234人

🌐 API統計:
• 気象庁API呼び出し: 1,890回
• Gemini API呼び出し: 1,234回
• API成功率: 99.8%

💾 システム情報:
• メモリ使用量: 245MB / 512MB
• CPU使用率: 12%
• データベースサイズ: 15.2MB
```

## エラーハンドリング

### 一般的なエラーメッセージ

#### 権限不足

```
❌ このコマンドを実行する権限がありません。

必要な権限: サーバー管理者
現在の権限: 一般ユーザー
```

#### API接続エラー

```
⚠️ 外部サービスとの接続に問題が発生しました。

• 気象庁API: 接続中...
• Google Gemini API: エラー

基本的な天気情報は表示できますが、AI機能は一時的に利用できません。
```

#### データベースエラー

```
⚠️ データの保存に失敗しました。

設定は一時的に保存されましたが、再起動後に失われる可能性があります。
しばらく時間をおいて再度お試しください。
```

#### レート制限

```
⏳ 一時的に利用制限がかかっています。

30秒後に再度お試しください。
頻繁にコマンドを実行すると制限がかかる場合があります。
```

### エラー時の対処法

1. **一時的なエラー**: 数分待ってから再試行
2. **権限エラー**: サーバー管理者に連絡
3. **設定エラー**: `/my-settings`で現在の設定を確認
4. **継続的な問題**: サーバー管理者またはボット開発者に報告

## 使用例とベストプラクティス

### 初回利用時の推奨手順

1. **地域設定**
   ```
   /set-location 東京都
   ```

2. **天気確認**
   ```
   /weather
   /forecast
   ```

3. **定時通知設定（オプション）**
   ```
   /schedule-weather 7
   ```

4. **設定確認**
   ```
   /my-settings
   ```

### 効率的な使い方

#### 日常的な使用パターン

```
# 朝の天気チェック
/weather

# 週末の計画立て
/forecast

# 悪天候時の警報確認
/weather-alerts
```

#### 旅行時の使用パターン

```
# 目的地の天気確認
/weather 沖縄県那覇市
/forecast 北海道札幌市

# 一時的な地域変更
/set-location 京都府京都市
/weather
# 帰宅後に元の地域に戻す
/set-location 東京都
```

### 注意事項

1. **コマンドの頻度**: 短時間に大量のコマンドを実行するとレート制限がかかります
2. **DM設定**: 定時通知を受け取るには、ボットからのDMを許可してください
3. **地域名**: 曖昧な地域名の場合、複数の候補が表示されることがあります
4. **AI機能**: Gemini APIが利用できない場合でも、基本的な天気情報は表示されます

### トラブル時のチェックリスト

- [ ] ボットがオンライン状態か確認
- [ ] 適切な権限でコマンドを実行しているか確認
- [ ] 地域名が正しく入力されているか確認
- [ ] DMの受信設定が有効になっているか確認（通知機能使用時）
- [ ] しばらく時間をおいて再試行

---

このコマンドリファレンスを参考に、Discord Weather Botを効果的にご利用ください。追加の質問や問題がある場合は、サーバー管理者またはサポートチームにお問い合わせください。